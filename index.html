<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Formulário para Planilha</title>
</head>
<body>

<h1>Formulário de Contato</h1>

<form id="formulario">
    <input type="text" name="nome" placeholder="Seu nome" required><br><br>
    <input type="email" name="email" placeholder="Seu email" required><br><br>
    <textarea name="mensagem" placeholder="Sua mensagem" required></textarea><br><br>
    <button type="submit">Enviar</button>
</form>
<h2>Mensagens recebidas:</h2>
<div id="dados"></div>

<script>
const formulario = document.getElementById('formulario');

formulario.addEventListener('submit', function(e) {
    e.preventDefault(); // Impede o envio tradicional

    const dados = {
        nome: formulario.nome.value,
        email: formulario.email.value,
        mensagem: formulario.mensagem.value
    };

    fetch('https://script.google.com/macros/s/AKfycbx0rdP4dyIaX4KshgMwV_79BbUXZlg7sdNOQdPTHtmQZk6a6wGfjfDnFMq_tUMRyKT46w/exec', {
        method: 'POST',
        body: JSON.stringify(dados),
        headers: {
            'Content-Type': 'application/json'
        },
        mode: 'no-cors'      
    })
    .then(response => response.text())
    .then(mensagem => {
        alert('Formulário enviado com sucesso!');
        formulario.reset(); // Limpa o formulário
    })
    .catch(error => {
        alert('Erro ao enviar formulário.');
        console.error(error);
    });
});
    fetch('https://script.google.com/macros/s/AKfycbx0rdP4dyIaX4KshgMwV_79BbUXZlg7sdNOQdPTHtmQZk6a6wGfjfDnFMq_tUMRyKT46w/exec')
  .then(response => response.json())
  .then(dados => {
      const divDados = document.getElementById('dados');
      dados.forEach(item => {
          divDados.innerHTML += `<p><strong>${item.nome}</strong> (${item.email}): ${item.mensagem}</p>`;
      });
  })
  .catch(error => {
      console.error('Erro ao buscar dados:', error);
  });
</script>

</body>
</html>
